{"componentChunkName":"component---src-templates-blog-post-js","path":"/til/mailchimp-gibbon-rails/","result":{"data":{"site":{"siteMetadata":{"title":"Chandler Moisen","author":"Chandler Moisen"}},"markdownRemark":{"id":"7a0e6b58-c369-5d07-ae79-db1090f533ab","excerpt":"You’ve made it to the big time when you want to start a mailing list. There are many ESP’s (email service providers) out there, each with respective strengths…","html":"<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c1db8ff1f884383b461ad66442ec4c71/5039d/logo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 250px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 110.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFv0lEQVQ4y12UCVCTRxTHP8TRzrTVOj1s7YzVVkWhAoqOEiFCbhIgJEBCwBBIOCKHICIeYEUqgqjoSGsFPEdRB9QiWqoMAmqtlksUQVSoF1DP2mqRI8n+u/k4OnZndvbNfvt+3/+93fcYho54pQcTqfSymkyc5ywbux6wds4EZryvUBmkVSj1DOMx1rq3UsGx2xSvMyQGeUdnaCWfsT7+IhtmeAQGLmQi/WWsHcufPWp43+jNjdLGpnRl5G3GkaIUXNnjVrl5VdLetUkJA3I/NeYt5EPC5d7aYZR/aD0f7ScchEb5Cdk1hu/Iwo4xzGi9RnUsZNspiPffR0z6CnPzj16mmpOpCDXEYuIMDt6d5Gh6Z9KcAQcnDhIDReJBoGBEDBumdd3DMGPCQ8MqVflX4VP0yCTZ326Zm3iIJCYtJ9PnS83MhFmm8ZPnkAlT5lnGTXaBiwunN0MntXtL4XLuVIbBYM7CQ0JKAwvqKOxhvyi/hcyPzoUq1Ei+cHDDtJlziczTg3h7LAZ3oZtpqr0rfHgexazjx842iUF+g+qCl6bYsqEHyL7VfFcN78MPBySFrcRBs57wJP7EnoalEnIRoxQhIUCEtSESYp0RPjxoxe4LrL4G6WLbRfZ2IxEzybxprpJlW+GR30Z8D7YTu+CNcHEVEg7HE6FeHkgIFGO1RohsgwQ7jDKyNUJkLkwJRrLWbyebqvSY//JnHWptVNXczIuYk1Nn+jp+H6Y7cYm7Gw8Gbx5SNBJkhYtQkKzCnlUa5MXJUZwZZXlRfwTlBelmvpODI5tDucDGaL3gRJHjYn7SLjhk1Vkc150lE50kZLazK8K8+UgOkmCLQYSKgnV4fu0E/ri8H12/HCB/XS8hpOPMwKOL+6D35qmtQL3Mg00dE6pWb1mYcQ7OOfWmqcpUMu7TWUQh8ESMQogMnQh7VwfjZXMZXtcfwJvmEvTeKkVPy0nSXrVnoPb4dkT5eoZZOQezV4weZzWCQvQn5uXUwj69xvTJbCHmOi8gUXIhvQQhssKEKM5aitfNJ/GyoQgtp7fj9s956Gk9RbpqSywdNQdQvDPtoYbPUY3kL9qXFy5KzgcvdgtJVHBJWrCAPlYhllKFORFe+GG5P55cPYzetjLcq96Lp3VH0dNRRR7f+Am9Dy5Z8KoFLTXHkB6tzhyBRnh7rknXeaEgUW6pLdpAtiQEI1SyGOk6KbZHe+HQN2G4Q5X13S2HqfsqTE8aiOXZNWJ+1gSajwHT7xXIWx3RSVHvs8AEtZc+Wy9Gxe41ZnSeJ7kr9WSJyB206JEdMQitO74VlqeNwIvrwHMKetZI+h/UkI7qvebmmlJkpSRcGVFoVEpU2QYpijcZ+3vvVZtLdqYhVOxOIv2EZJWaj8sH11MlTejvrkPXjbN4UH8azZWH0HDuKNpvNhIA5ta6C0jVK7YNEsc62iapxed3GH1QmKLB1tgAi/UNLlWISKZOgMqCVOB1K1qqi3Dz0hk8776Pf/58AmLqJYTi2lsaTZ3XyrExXruZ0cn4bFELOe7vxfmL4+OV/OtGOR+RvgKz9aY3GySkIEVD+jqv4H7dKbRePoMXXR14fO8WudN0lTRUlpBXbeUo/T6t7yNm1JTBtyjljzTIMF/xV1FyQT9tR4jw5ZszDTJsMwjIr8XbCPo6rCGTu7+VkY7aMvLybhVVfr3/dkUhjH6CXGaoZNjV4CNgYhSCMUO9TU/VgoIRqxQObNCJSf6KQNJx6QjBq5sEb9qAvjsWekn9F0p20TcrbnKbOWP8W/UcIuAwy1RShnYRttApTE/nQCwF016HpECBeZ1WbN6dGmE+mrvGvC8rGenGYFC/C1qRmwP1/fItYPRQ544NkPwH9RPMpNAiOv82KkSwToPME+FeXCwRLuqmoDSqmD2rdHOxYf4/jEPQBLXUqtB2eJ9Wzef0mw9d4+gP4+JVUlnmMt0Hw9/pWRYaKecz/wIawSflN/4rmAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"mailchip logo\"\n        title=\"\"\n        src=\"/static/c1db8ff1f884383b461ad66442ec4c71/5039d/logo.png\"\n        srcset=\"/static/c1db8ff1f884383b461ad66442ec4c71/cf440/logo.png 148w,\n/static/c1db8ff1f884383b461ad66442ec4c71/5039d/logo.png 250w\"\n        sizes=\"(max-width: 250px) 100vw, 250px\"\n      />\n  </span>\n  </a></p>\n<p>You’ve made it to the big time when you want to start a mailing list. There are many ESP’s (email service providers) out there, each with respective strengths and weaknesses. I’d recommend checking into <a href=\"https://mailchimp.com/\">MailChimp</a> as they provide an “entrepreneur’s plan” that allows you to send 12,000 emails a month to 2,000 subscribers – <strong>for free, for life.</strong> And because I have no experience with any other ESP…</p>\n<p>This tutorial will cover MailChimp’s integration with Rails using the <a href=\"https://github.com/amro/gibbon\">Gibbon</a> gem. We will be building a simple Rails application that will display a form to collects users’ email addresses and add them to a MailChimp email list.</p>\n<p>It is assumed that you possess a basic/intermediate understanding of Ruby (v. 1.9.3) and Rails (v. 4.0.2).</p>\n<p><strong>Note:</strong> this tutorial covers MailChimp’s V2 of their API.</p>\n<hr>\n<h2>Part One: MailChimp</h2>\n<p>Before we jump into Rails, we need to do three things: 1) obtain our API key, 2) make an email list with MailChimp; 3) obtain that list’s ID.</p>\n<p><strong>1)</strong> Once logged into your MailChimp account, look to the left, select your name, and then “Account Settings” in the popup menu. Next, click the “Extras” dropdown and select “API Keys”. Voilla, you have your API key.</p>\n<p><strong>2)</strong> To generate an email list, select “Lists” from the menu on the left. In the top-right corner, click “Create List” to begin the process. Hint: it’s relatively straight forward.</p>\n<p><strong>3)</strong> To get the ID of the list you just created, select “List” from the menu on the left. This displays a list of lists…Click on the name of your new list, then the “Settings” dropdown, and select “List name &#x26; defaults”. Now you have your list ID. Super.</p>\n<hr>\n<h2>Part Two: Rails</h2>\n<p>The Rails integration involves five steps: 1) adding the Gibbon gem to your gemfile; 2) creating an intializer file; 3) generating a controller and 4) a view; and 5) configuring your routes.</p>\n<p><strong>1)</strong> Add the Gibbon gem to your gemfile and run bundle in your terminal. <a href=\"https://github.com/amro/gibbon\">Gibbon is an API wrapper for MailChimp’s Primary and Export APIs</a>, or, in other words, a chunk of code you can drop into your project and work with quickly. There are quite a few MailChimp API Wrappers spanning a variety of languages.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">#Gemfile</span>\n\ngem <span class=\"token string\">'gibbon'</span><span class=\"token punctuation\">,</span> git<span class=\"token punctuation\">:</span> <span class=\"token string\">'git://github.co/amro/gibbon.git'</span></code></pre></div>\n<p>Take note: other <a href=\"http://mrgeorgegray.com/workflow/getting-a-grip-on-gibbon/\">tutorials</a> reported issues running the correct version of the gem. If you encounter a similar problem, try adding <code class=\"language-text\">git: ‘git://github.co/amro/gibbon.git’</code> to your gemfile so it points to the gem’s repository.</p>\n<p><strong>2)</strong> Create a new initializer file, ‘gibbon.rb’, in ‘config/initializers’ to declare your MailChimp API key and two other variables. Setting throws_exception to false will give you a pretty hash in the event of an error.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">#config/initializers/gibbon.rb</span>\n\n<span class=\"token constant\">Gibbon</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">API</span><span class=\"token punctuation\">.</span>api_key <span class=\"token operator\">=</span> <span class=\"token string\">\"YOUR-API-KEY\"</span>\n<span class=\"token constant\">Gibbon</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">API</span><span class=\"token punctuation\">.</span>timeout <span class=\"token operator\">=</span> <span class=\"token number\">15</span>\n<span class=\"token constant\">Gibbon</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">API</span><span class=\"token punctuation\">.</span>throws_exceptions <span class=\"token operator\">=</span> <span class=\"token keyword\">false</span></code></pre></div>\n<p><strong>3)</strong> Generate a controller <code class=\"language-text\">emailapi</code> to handle MailChimp’s API calls and create a method <code class=\"language-text\">subscribe</code> that will be responsible for taking users’ email input and pushing it to your mailing list.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">#app/controllers/emailapi_controller.rb</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">index</span></span>\n<span class=\"token keyword\">end</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">subscribe</span></span>\n\n    <span class=\"token variable\">@list_id</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"YOUR-LIST-ID\"</span>\n    gb <span class=\"token operator\">=</span> <span class=\"token constant\">Gibbon</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token constant\">API</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">new</span>\n\n    <span class=\"token class-name\">gb<span class=\"token punctuation\">.</span>lists<span class=\"token punctuation\">.</span>subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token symbol\">:id</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">@list_id</span><span class=\"token punctuation\">,</span>\n      <span class=\"token symbol\">:email</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token symbol\">:email</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> params<span class=\"token punctuation\">[</span><span class=\"token symbol\">:email</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token symbol\">:address</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>The variables <code class=\"language-text\">@list_id</code> and <code class=\"language-text\">gb</code> are respectively defined as the ID of the list you created (from Part One, remember?) and an instance of the API wrapper. The latter is pulling from the <code class=\"language-text\">app/config/initializers/gibbon.rb</code>.</p>\n<p>Next, we make an API call – <code class=\"language-text\">.lists.subscribe()</code> – on the instance itself. This call takes a hash as an argument, and in this hash, we pass two parameters: <code class=\"language-text\">:id</code>, associated with the ID of your list, and <code class=\"language-text\">:email</code>, associated with the user’s email (this will become clearer after we construct the view).</p>\n<p><strong>4)</strong> Having completed the controller, let’s make the corresponding view. Create a file <code class=\"language-text\">index.html.erb</code> in <code class=\"language-text\">/app/views/emailapi</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">#app/views/emailapi/index.html.erb</span>\n\n<span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span><span class=\"token constant\">Get</span> <span class=\"token constant\">My</span> <span class=\"token constant\">Awesome</span> <span class=\"token constant\">News</span> <span class=\"token constant\">Letter</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token constant\">Give</span> me your email <span class=\"token keyword\">and</span> keep up to date on my cat's thoughts<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token string\">%= form_tag('/emailapi/subscribe', method: \"post\", id: \"subscribe\", remote: \"true\") do -%>\n   &lt;%=</span> email_field<span class=\"token punctuation\">(</span><span class=\"token symbol\">:email</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:address</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">:</span> <span class=\"token string\">\"email\"</span><span class=\"token punctuation\">,</span> placeholder<span class=\"token punctuation\">:</span> <span class=\"token string\">\"email address\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token string\">%>\n   &lt;%= submit_tag(\"Sign me up!\") %></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">end</span> <span class=\"token operator\">%</span><span class=\"token operator\">></span></code></pre></div>\n<p>Beneath the <code class=\"language-text\">&lt;h1&gt;</code> and <code class=\"language-text\">&lt;p&gt;</code> html elements, use a Rails helper <code class=\"language-text\">form_tag</code> to create the sign up form. Pass in four paramaters:</p>\n<ol>\n<li>The action the form is going to take, or where the form will be submitted</li>\n<li>The HTML method defining how the action will occur, in this case <code class=\"language-text\">post</code></li>\n<li>The form’s ID</li>\n<li>Set <code class=\"language-text\">remote</code> to <code class=\"language-text\">true</code>, allowing unobtrusive JS drivers to modify the the form’s behavior.</li>\n</ol>\n<p>Lastl, the <code class=\"language-text\">submit_tag</code> method creates our <code class=\"language-text\">&lt;input&gt;</code> tags. Our form is rendered in HTML as seen below:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>Get My Awesome News Letter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>Give me your email and keep up to date on my cat's thoughts.<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">accept-charset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">action</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>/emailapi/subscribe<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-remote</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>subscribe<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token property\">margin</span><span class=\"token punctuation\">:</span>0<span class=\"token punctuation\">;</span><span class=\"token property\">padding</span><span class=\"token punctuation\">:</span>0<span class=\"token punctuation\">;</span><span class=\"token property\">display</span><span class=\"token punctuation\">:</span>inline</span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>utf8<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>hidden<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span><span class=\"token entity\" title=\"&#x2713;\">&amp;#x2713;</span><span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email[address]<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email address<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>email<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n   <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>commit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Sign me up!<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>To learn more about forms, check out the <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html\">documentation</a>.</p>\n<p>For more information on the subscribe API call, check out the <a href=\"https://developer.mailchimp.com/documentation/mailchimp/reference/lists/members/#create-post_lists_list_id_members\">official documentation</a>.</p>\n<p><strong>5)</strong> Last, set your routes in <code class=\"language-text\">config/routes.rb</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">#config/routes.rb</span>\n\nroot <span class=\"token string\">'emailapi#index'</span>\npost <span class=\"token string\">'emailapi/subscribe'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'emailapi#subscribe'</span></code></pre></div>\n<hr>\n<h2>Conclusion</h2>\n<p>Alright, you should be good to go. Keep in mind, this tutorial barely scratches the surface of MailChimp + Rails + Gibbon.</p>","frontmatter":{"title":"MailChimp, Gibbon, and Rails - Basic Mailing List Setup","date":"January 23, 2014","isTIL":null}}},"pageContext":{"slug":"/mailchimp-gibbon-rails/","previous":{"fields":{"slug":"/twilio-on-rails-sms-basics/"},"frontmatter":{"title":"Twilio on Rails - SMS Basics"}},"next":{"fields":{"slug":"/roll-your-own-static-site/"},"frontmatter":{"title":"Roll Your Own Static Site"}}}}}