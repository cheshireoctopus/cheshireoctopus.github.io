{"data":{"site":{"siteMetadata":{"title":"Chandler Moisen","author":"Chandler Moisen"}},"markdownRemark":{"id":"eeb0c98f-dc36-5db6-8959-c2b5ba56720e","excerpt":"rolling on fridayRecently I decided to rebuild my long neglected and dilapidated blog - previously powered by Octopress - using JavaScript.As a blog is a…","html":"<p><img src=\"/rolling-054ca163e31520d2625820020aa4870a.gif\" alt=\"rolling on friday\"></p>\n<p>Recently I decided to rebuild my long neglected and dilapidated blog - previously powered by <a href=\"http://octopress.org/\">Octopress</a> - using JavaScript.</p>\n<p>As a blog is a perfect use case for a static site generator, I first investigated existing solutions, and found, as expected, there are already quite a few available:</p>\n<ul>\n<li><a href=\"http://www.metalsmith.io/\">Metalsmith</a></li>\n<li><a href=\"https://hexo.io/\">Hexo</a></li>\n<li><a href=\"http://wintersmith.io/\">Wintersmith</a></li>\n</ul>\n<p>See <a href=\"https://www.staticgen.com/\">https://www.staticgen.com/</a> for even more.</p>\n<p>While more than sufficient, I found these to be overkill as all I really needed was to <strong>convert some markdown into HTML</strong>.</p>\n<p>Add a pinch of CSS, maybe your favorite frontend view layer, and that’s it - you’re cruising.</p>\n<p>So, as any self-respecting dev would do, I rolled my own with React - check it out <a href=\"https://github.com/cheshireoctopus/cheshireoctopus.github.io\">here</a>.</p>\n<h2>Structure</h2>\n<p>The structure (simplified below) is pretty straight-forward:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">|-- app\n|\t|-- components\n|\t|-- index.js\n|\t|-- posts.json\n|\t|-- projects.json\n|-- bin\n|\t|-- gen\n|-- public\n|\t|-- blog\n|\t\t|-- my_first_post\n|\t\t\t|-- img\n|\t\t\t|-- data.json\n|\t\t\t|-- post.md\n|-- index.html\n|-- webpack.confg.js</code></pre></div>\n<p><code class=\"language-text\">app/components/</code> holds all the <code class=\"language-text\">.jsx</code>, and uses <code class=\"language-text\">posts.json</code> - created via <code class=\"language-text\">bin/gen</code> (see below) - to populate the blog posts.</p>\n<p>Blog posts are stored as individual directories in <code class=\"language-text\">public/blog/</code>; each post directory contains:</p>\n<ul>\n<li><code class=\"language-text\">data.json</code></li>\n<li><code class=\"language-text\">post.md</code></li>\n<li><code class=\"language-text\">img/</code></li>\n</ul>\n<p><code class=\"language-text\">data.json</code> contains post-specific metadata (<code class=\"language-text\">title</code>, <code class=\"language-text\">date</code>, <code class=\"language-text\">topics</code>), while <code class=\"language-text\">post.md</code> contains the related markdown content; <code class=\"language-text\">img/</code> holds the post’s images.</p>\n<p>See an example <a href=\"https://github.com/cheshireoctopus/cheshireoctopus.github.io/tree/master/public/blog/twilio_on_rails_sms_basics\">here</a>.</p>\n<p>Running <code class=\"language-text\">./bin/gen</code> from root parses through each post directory in <code class=\"language-text\">public/blog/</code>, transforms the <code class=\"language-text\">post.md</code> file into HTML, and then adds this string under the key <code class=\"language-text\">html</code> to the relative <code class=\"language-text\">data.json</code> object. Each JSON object is then pushed to an array and outputted at <code class=\"language-text\">app/posts.json</code> for use inside the React app.</p>\n<h2>Markdown to HTML</h2>\n<p>The core of the blog is powered by a single shell script that rips through a bunch of markdown files, converting them into HTML:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber 0\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">#<span class=\"token operator\">!</span><span class=\"token operator\">/</span>usr<span class=\"token operator\">/</span>bin<span class=\"token operator\">/</span>env node\n\n<span class=\"token keyword\">const</span> Promise <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bluebird'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">promisifyAll</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> marked <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'marked'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> highlightjs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'highlight.js'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PATH_TO_ROOT</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'..'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PATH_TO_APP</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PATH_TO_ROOT</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'app'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">PATH_TO_SRC</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PATH_TO_ROOT</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'blog'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">marked<span class=\"token punctuation\">.</span>Renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nrenderer<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">code</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">code<span class=\"token punctuation\">,</span> language</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> validLang <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>language <span class=\"token operator\">&amp;&amp;</span> highlightjs<span class=\"token punctuation\">.</span><span class=\"token function\">getLanguage</span><span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">const</span> highlighted <span class=\"token operator\">=</span> validLang <span class=\"token operator\">?</span> highlightjs<span class=\"token punctuation\">.</span><span class=\"token function\">highlight</span><span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">:</span> code\n\t<span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token string\">`&lt;pre>&lt;code class=\"hljs </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>language<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>highlighted<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/code>&lt;/pre>`</span></span>\n<span class=\"token punctuation\">}</span>\nrenderer<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">image</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">src<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> alt</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token string\">`&lt;div class=\"post-image-container\">&lt;img src=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>src<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\" alt=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>alt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"/>&lt;/div>`</span></span>\n<span class=\"token punctuation\">}</span>\n\nmarked<span class=\"token punctuation\">.</span><span class=\"token function\">setOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\trenderer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">readdirAsync</span><span class=\"token punctuation\">(</span><span class=\"token constant\">PATH_TO_SRC</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">posts</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>posts<span class=\"token punctuation\">,</span> <span class=\"token parameter\">postDir</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">const</span> srcPostDir <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PATH_TO_SRC</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>postDir<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span>\n\n\t\t\t<span class=\"token keyword\">return</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readdirAsync</span><span class=\"token punctuation\">(</span>srcPostDir<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">files</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token keyword\">const</span> readJSON <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileAsync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>srcPostDir<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/data.json`</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\n\t\t\t\t\t<span class=\"token keyword\">const</span> readMD <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileAsync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>srcPostDir<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/post.md`</span></span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\n\n\t\t\t\t\t<span class=\"token keyword\">return</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>readJSON<span class=\"token punctuation\">,</span> readMD<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">json<span class=\"token punctuation\">,</span> md<span class=\"token punctuation\">,</span> imgs</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t<span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">)</span>\n\n\t\t\t\t\t\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t\tdate<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\ttopics<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>topics<span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\ttitle<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\turlTitle<span class=\"token punctuation\">:</span> postDir<span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t\thtml<span class=\"token punctuation\">:</span> <span class=\"token function\">marked</span><span class=\"token punctuation\">(</span>md<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\t\t\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">postCollection</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\tpostCollection <span class=\"token operator\">=</span> postCollection<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n\t\tfs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileAsync</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token constant\">PATH_TO_APP</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/posts.json`</span></span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>postCollection<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t\t\t<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`Congratulations - generated </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>postCollection<span class=\"token punctuation\">.</span>length<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> posts.`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>Bluebird’s <code class=\"language-text\">.promisifyAll</code></h2>\n<p>A quick note: asynchronous file input/output can quickly lead to a labyrinth of callbacks. To help mitigate sphagetti code, you’ll see that I leveraged <code class=\"language-text\">Bluebird.promisifyAll</code> (<a href=\"http://bluebirdjs.com/docs/api/promise.promisifyall.html\">documentation</a>) by wrapping Node’s <code class=\"language-text\">fs</code> module:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> Promise <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bluebird'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> Promise<span class=\"token punctuation\">.</span><span class=\"token function\">promisifyAll</span><span class=\"token punctuation\">(</span><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><code class=\"language-text\">.promisifyAll</code> parses through an object, “promisifying” the object’s methods. These new promises are accessed via the original method’s name + a suffix of <code class=\"language-text\">Async</code>.</p>\n<p>For example, to read a directory using <code class=\"language-text\">fs</code>, one would typically call <code class=\"language-text\">fs.readdir</code>; when wrapped using <code class=\"language-text\">promisifyAll</code> one would call <code class=\"language-text\">fs.readdirAsync</code>.</p>\n<h2>Marked: Custom Parsers</h2>\n<p>To convert markdown into HTML, I relied upon <a href=\"https://github.com/chjj/marked\">marked</a> and <a href=\"https://highlightjs.org/\">highlight.js</a>.</p>\n<p>While marked will convert markdown to HTML out of the box, it does require custom configuration when rendering code blocks and applying syntax highlighting. Thankfully, this process is pretty easy, thanks to hightlight.js.</p>\n<p>The majority of marked’s configuration can be accessed via its <a href=\"https://github.com/chjj/marked#renderer\">marked.Renderer()</a> API. This allows the developer to define functions which are invoked when parsing certain <a href=\"https://github.com/chjj/marked#block-level-renderer-methods\">block</a> or <a href=\"https://github.com/chjj/marked#inline-level-renderer-methods\">inline</a> elements.</p>\n<p>For example, to apply custom markup to an image element, first instantiate a new <code class=\"language-text\">Renderer()</code> object, define an <code class=\"language-text\">image</code> method on this object describing what HTML should returned when parsing an image, and finally use <code class=\"language-text\">.setOptions</code> to apply the custom rendering.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> marked <span class=\"token keyword\">from</span> <span class=\"token string\">'marked'</span>\n\n<span class=\"token keyword\">const</span> renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">marked<span class=\"token punctuation\">.</span>Renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nrenderer<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">image</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">src<span class=\"token punctuation\">,</span> title<span class=\"token punctuation\">,</span> alt</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token string\">`&lt;div class=\"post-image-container\">&lt;img src=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>src<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\" alt=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>alt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"/>&lt;/div>`</span></span>\n<span class=\"token punctuation\">}</span>\n\nmarked<span class=\"token punctuation\">.</span><span class=\"token function\">setOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\trenderer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Applying custom rendering to a code block would be similar, except you would utilize hightlight.js to apply syntax highlighting. Check out this <a href=\"http://shuheikagawa.com/blog/2015/09/21/using-highlight-js-with-marked/\">post</a> for some more detail.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> marked <span class=\"token keyword\">from</span> <span class=\"token string\">'marked'</span>\n<span class=\"token keyword\">import</span> highlightjs <span class=\"token keyword\">from</span> <span class=\"token string\">'highlight.js'</span>\n\n<span class=\"token keyword\">const</span> renderer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">marked<span class=\"token punctuation\">.</span>Renderer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nrenderer<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">code</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">code<span class=\"token punctuation\">,</span> language</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token keyword\">const</span> validLang <span class=\"token operator\">=</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span>language <span class=\"token operator\">&amp;&amp;</span> highlightjs<span class=\"token punctuation\">.</span><span class=\"token function\">getLanguage</span><span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\t<span class=\"token keyword\">const</span> highlighted <span class=\"token operator\">=</span> validLang <span class=\"token operator\">?</span> highlightjs<span class=\"token punctuation\">.</span><span class=\"token function\">highlight</span><span class=\"token punctuation\">(</span>language<span class=\"token punctuation\">,</span> code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>value <span class=\"token punctuation\">:</span> code\n\t<span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token string\">`&lt;pre>&lt;code class=\"hljs </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>language<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>highlighted<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/code>&lt;/pre>`</span></span>\n<span class=\"token punctuation\">}</span>\n\nmarked<span class=\"token punctuation\">.</span><span class=\"token function\">setOptions</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n\trenderer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>One caveat when hightlight.js - it does not ship with line numbers in code blocks. According to the library’s author(s), this is <a href=\"http://highlightjs.readthedocs.io/en/latest/line-numbers.html\">“not an oversight but a feature”</a>, and it does appear that a <a href=\"https://github.com/wcoder/highlightjs-line-numbers.js/\">plugin</a> was built to add them in.</p>","frontmatter":{"title":"Roll Your Own Static Site","date":"June 12, 2017"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/roll-your-own-static-site/","previous":{"fields":{"slug":"/twilio-on-rails-sms-basics/"},"frontmatter":{"title":"Twilio on Rails - SMS Basics"}},"next":{"fields":{"slug":"/js-class-fields-proposal-at-stage-3/"},"frontmatter":{"title":"JS Class Fields Proposal Stage 3 Update, BabelJS, and Airbnb's JS Style Guide"}}}}